<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Crear Pregunta Frecuente - {{ empresa.nombre }}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
    
    body {
      font-family: 'Inter', sans-serif;
      background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
      min-height: 100vh;
    }
    
    .gradient-header {
      background: linear-gradient(135deg, #059669 0%, #047857 100%);
    }
    
    .card-shadow {
      box-shadow: 0 10px 30px -10px rgba(0, 0, 0, 0.08), 0 4px 6px -4px rgba(0, 0, 0, 0.02);
    }
    
    .hover-lift {
      transition: all 0.3s ease;
    }
    
    .hover-lift:hover {
      transform: translateY(-2px);
      box-shadow: 0 20px 40px -10px rgba(0, 0, 0, 0.12);
    }
    
    .btn-primary {
      background: linear-gradient(135deg, #059669 0%, #047857 100%);
      transition: all 0.3s ease;
    }
    
    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 25px -5px rgba(5, 150, 105, 0.3);
    }
    
    .input-focus:focus {
      box-shadow: 0 0 0 3px rgba(5, 150, 105, 0.15);
      border-color: #059669;
    }
    
    .toggle-switch {
      position: relative;
      display: inline-block;
      width: 60px;
      height: 30px;
    }
    
    .toggle-switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }
    
    .toggle-slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(135deg, #d1d5db 0%, #9ca3af 100%);
      transition: .4s;
      border-radius: 34px;
    }
    
    .toggle-slider:before {
      position: absolute;
      content: "";
      height: 22px;
      width: 22px;
      left: 4px;
      bottom: 4px;
      background-color: white;
      transition: .4s;
      border-radius: 50%;
    }
    
    input:checked + .toggle-slider {
      background: linear-gradient(135deg, #059669 0%, #047857 100%);
    }
    
    input:checked + .toggle-slider:before {
      transform: translateX(30px);
    }
    
    .textarea-autoresize {
      resize: none;
      min-height: 150px;
      max-height: 400px;
    }
    
    .category-chip {
      display: inline-flex;
      align-items: center;
      padding: 0.5rem 0.875rem;
      border-radius: 9999px;
      font-size: 0.875rem;
      font-weight: 500;
      margin: 0.25rem;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    
    .category-chip:hover {
      transform: translateY(-1px);
    }
    
    .form-section {
      background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
      border: 1px solid #a7f3d0;
      border-radius: 12px;
    }
    
    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    .animate-fade-in {
      animation: fadeIn 0.4s ease-out;
    }
    
    .preview-card {
      border-left: 4px solid #10b981;
      background: white;
    }
  </style>
</head>
<body>

  <!-- Header -->
  <header class="gradient-header text-white shadow-lg">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
      <div class="flex justify-between items-center">
        <div class="flex items-center space-x-3">
          <div class="h-12 w-12 bg-white/20 rounded-xl flex items-center justify-center">
            <i class="fas fa-question-circle text-white text-xl"></i>
          </div>
          <div>
            <h1 class="text-2xl font-bold">Crear Pregunta Frecuente</h1>
            <p class="text-sm opacity-90 mt-0.5">{{ empresa.nombre }}</p>
          </div>
        </div>
        
        <div class="flex items-center space-x-4">
          <a href="{% url 'faq_listado' slug=slug %}" 
             class="text-white hover:bg-white/20 px-4 py-2.5 rounded-lg transition-colors flex items-center">
            <i class="fas fa-arrow-left mr-2"></i> Volver al listado
          </a>
          <a href="{% url 'panel_empresa' slug=slug %}" 
             class="text-white hover:bg-white/20 px-4 py-2.5 rounded-lg transition-colors flex items-center">
            <i class="fas fa-tachometer-alt mr-2"></i> Panel
          </a>
        </div>
      </div>
    </div>
  </header>

  <main class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    
    <!-- Información de ayuda -->
    <div class="mb-8 form-section p-5">
      <div class="flex items-center">
        <div class="h-12 w-12 rounded-lg bg-emerald-100 flex items-center justify-center mr-4">
          <i class="fas fa-lightbulb text-emerald-600"></i>
        </div>
        <div>
          <h3 class="font-semibold text-emerald-900">Consejos para crear preguntas efectivas</h3>
          <p class="text-sm text-emerald-700 mt-1">
            <i class="fas fa-check-circle mr-1.5"></i> Sea claro y directo en la pregunta<br>
            <i class="fas fa-check-circle mr-1.5"></i> Proporcione respuestas completas y útiles<br>
            <i class="fas fa-check-circle mr-1.5"></i> Use categorías para organizar el contenido
          </p>
        </div>
      </div>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
      
      <!-- Formulario de creación -->
      <div class="lg:col-span-1">
        <div class="bg-white rounded-xl card-shadow p-6 hover-lift animate-fade-in">
          <div class="flex items-center mb-6">
            <div class="h-10 w-10 rounded-lg bg-emerald-100 flex items-center justify-center mr-3">
              <i class="fas fa-plus text-emerald-600"></i>
            </div>
            <h2 class="text-xl font-semibold text-gray-900">Nueva Pregunta Frecuente</h2>
          </div>
          
          <form method="POST" action="{% url 'crear_faq' slug=slug %}" class="space-y-6">
            {% csrf_token %}
            
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">
                <i class="fas fa-question-circle mr-1.5 text-gray-400"></i>Pregunta
              </label>
              <input type="text" name="pregunta" required 
                     class="w-full px-4 py-3 border border-gray-300 rounded-lg input-focus transition-colors"
                     placeholder="¿Cómo puedo realizar mi pago?"
                     maxlength="200"
                     id="preguntaInput">
              <div class="flex justify-between mt-1">
                <p class="text-xs text-gray-500">Pregunta clara y concisa</p>
                <p class="text-xs text-gray-500">
                  <span id="preguntaCounter">0</span>/200
                </p>
              </div>
            </div>
            
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">
                <i class="fas fa-comment-dots mr-1.5 text-gray-400"></i>Respuesta
              </label>
              <textarea name="respuesta" rows="6" required 
                        class="w-full px-4 py-3 border border-gray-300 rounded-lg textarea-autoresize input-focus transition-colors"
                        placeholder="Proporcione una respuesta detallada y útil..."
                        maxlength="1000"
                        id="respuestaInput"></textarea>
              <div class="flex justify-between mt-1">
                <p class="text-xs text-gray-500">Respuesta completa y útil</p>
                <p class="text-xs text-gray-500">
                  <span id="respuestaCounter">0</span>/1000
                </p>
              </div>
            </div>
            
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">
                <i class="fas fa-tags mr-1.5 text-gray-400"></i>Categoría
              </label>
              <input type="text" name="categoria" 
                     class="w-full px-4 py-3 border border-gray-300 rounded-lg input-focus transition-colors"
                     placeholder="Ej: Pagos, Servicio, Técnico"
                     id="categoriaInput">
              <div class="mt-2">
                <p class="text-xs text-gray-500 mb-2">Categorías sugeridas:</p>
                <div class="flex flex-wrap gap-2">
                  <span class="category-chip bg-blue-100 text-blue-800" onclick="setCategory('Pagos')">
                    <i class="fas fa-money-bill-wave mr-1.5"></i>Pagos
                  </span>
                  <span class="category-chip bg-green-100 text-green-800" onclick="setCategory('Servicio')">
                    <i class="fas fa-concierge-bell mr-1.5"></i>Servicio
                  </span>
                  <span class="category-chip bg-purple-100 text-purple-800" onclick="setCategory('Técnico')">
                    <i class="fas fa-tools mr-1.5"></i>Técnico
                  </span>
                  <span class="category-chip bg-amber-100 text-amber-800" onclick="setCategory('General')">
                    <i class="fas fa-info-circle mr-1.5"></i>General
                  </span>
                  <span class="category-chip bg-red-100 text-red-800" onclick="setCategory('Documentos')">
                    <i class="fas fa-file-alt mr-1.5"></i>Documentos
                  </span>
                </div>
              </div>
            </div>
            
            <!-- Estado -->
            <div class="p-4 bg-gray-50 rounded-lg border border-gray-200">
              <div class="flex items-center justify-between">
                <div>
                  <p class="text-sm font-medium text-gray-900">Estado de la Pregunta</p>
                  <p class="text-xs text-gray-500 mt-0.5">
                    Las preguntas activas son visibles para los clientes
                  </p>
                </div>
                
                <label class="toggle-switch">
                  <input type="checkbox" name="activa" checked id="activaCheckbox">
                  <span class="toggle-slider"></span>
                </label>
              </div>
              
              <div class="mt-3 flex items-center">
                <div class="h-8 w-8 rounded-lg bg-emerald-100 flex items-center justify-center mr-2">
                  <i class="fas fa-eye text-emerald-600"></i>
                </div>
                <div>
                  <p class="text-xs font-medium text-gray-900">Visibilidad actual</p>
                  <p class="text-xs text-emerald-700" id="estadoTexto">Activa (visible para clientes)</p>
                </div>
              </div>
            </div>
            
            <!-- Acciones -->
            <div class="pt-4 border-t border-gray-100">
              <div class="flex justify-between items-center">
                <button type="button" onclick="clearForm()" 
                        class="px-5 py-2.5 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors font-medium flex items-center">
                  <i class="fas fa-redo mr-2"></i> Limpiar
                </button>
                
                <button type="submit" 
                        class="btn-primary text-white px-6 py-2.5 rounded-lg font-medium flex items-center">
                  <i class="fas fa-save mr-2"></i> Guardar Pregunta
                </button>
              </div>
            </div>
          </form>
        </div>
      </div>
      
      <!-- Vista previa -->
      <div class="lg:col-span-1">
        <div class="sticky top-8">
          <div class="bg-white rounded-xl card-shadow p-6 mb-6">
            <div class="flex items-center mb-4">
              <div class="h-10 w-10 rounded-lg bg-blue-100 flex items-center justify-center mr-3">
                <i class="fas fa-eye text-blue-600"></i>
              </div>
              <h3 class="text-lg font-semibold text-gray-900">Vista Previa</h3>
            </div>
            
            <div class="preview-card rounded-lg p-5 border border-gray-200">
              <div class="flex justify-between items-start mb-3">
                <div class="flex items-start">
                  <div class="h-8 w-8 rounded-lg bg-emerald-100 flex items-center justify-center mr-2">
                    <span class="text-emerald-600 font-bold">Q</span>
                  </div>
                  <h4 class="font-semibold text-gray-900" id="previewPregunta">¿Pregunta de ejemplo?</h4>
                </div>
                <span id="previewEstado" class="text-xs px-3 py-1 rounded-full bg-emerald-100 text-emerald-800">
                  <i class="fas fa-eye mr-1"></i> Activa
                </span>
              </div>
              
              <div class="mt-4">
                <div class="flex items-start mb-2">
                  <div class="h-8 w-8 rounded-lg bg-blue-100 flex items-center justify-center mr-2">
                    <span class="text-blue-600 font-bold">A</span>
                  </div>
                  <div class="flex-1">
                    <p class="text-sm text-gray-700 whitespace-pre-line" id="previewRespuesta">
                      La respuesta aparecerá aquí...
                    </p>
                  </div>
                </div>
              </div>
              
              <div class="mt-4 pt-4 border-t border-gray-100">
                <div class="flex items-center justify-between text-xs text-gray-500">
                  <div>
                    <span id="previewCategoria" class="px-2 py-1 rounded bg-gray-100 text-gray-800">
                      Sin categoría
                    </span>
                  </div>
                  <div>
                    <i class="far fa-calendar mr-1"></i>
                    Vista previa
                  </div>
                </div>
              </div>
            </div>
            
            <div class="mt-4 text-xs text-gray-500">
              <p class="flex items-start">
                <i class="fas fa-info-circle text-blue-500 mt-0.5 mr-2"></i>
                Esta es una vista previa de cómo se verá la pregunta en el listado de FAQs.
              </p>
            </div>
          </div>
          
          <!-- Información adicional -->
          <div class="bg-gradient-to-r from-blue-50 to-purple-50 border border-blue-200 rounded-xl p-5">
            <div class="flex items-start">
              <div class="h-10 w-10 rounded-lg bg-blue-100 flex items-center justify-center mr-3 flex-shrink-0">
                <i class="fas fa-tips text-blue-600"></i>
              </div>
              <div>
                <h3 class="text-sm font-semibold text-blue-900 mb-1">Buenas prácticas para FAQs</h3>
                <ul class="text-xs text-blue-800 space-y-1">
                  <li class="flex items-start">
                    <i class="fas fa-check text-blue-500 text-xs mt-0.5 mr-2"></i>
                    <span>Use lenguaje claro y sencillo</span>
                  </li>
                  <li class="flex items-start">
                    <i class="fas fa-check text-blue-500 text-xs mt-0.5 mr-2"></i>
                    <span>Incluya pasos específicos cuando sea posible</span>
                  </li>
                  <li class="flex items-start">
                    <i class="fas fa-check text-blue-500 text-xs mt-0.5 mr-2"></i>
                    <span>Mantenga respuestas actualizadas</span>
                  </li>
                  <li class="flex items-start">
                    <i class="fas fa-check text-blue-500 text-xs mt-0.5 mr-2"></i>
                    <span>Organice por categorías lógicas</span>
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Navegación -->
    <div class="mt-8 text-center">
      <a href="{% url 'faq_listado' slug=slug %}" 
         class="text-gray-600 hover:text-gray-900 hover:bg-gray-100 px-4 py-2.5 rounded-lg transition-colors flex items-center justify-center inline-flex">
        <i class="fas fa-arrow-left mr-2"></i>
        Volver al listado de preguntas frecuentes
      </a>
    </div>
  </main>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Contadores de caracteres
      const preguntaInput = document.getElementById('preguntaInput');
      const respuestaInput = document.getElementById('respuestaInput');
      const preguntaCounter = document.getElementById('preguntaCounter');
      const respuestaCounter = document.getElementById('respuestaCounter');
      
      // Inicializar contadores
      preguntaCounter.textContent = preguntaInput.value.length;
      respuestaCounter.textContent = respuestaInput.value.length;
      
      // Actualizar contadores en tiempo real
      preguntaInput.addEventListener('input', function() {
        preguntaCounter.textContent = this.value.length;
        updatePreview();
      });
      
      respuestaInput.addEventListener('input', function() {
        respuestaCounter.textContent = this.value.length;
        updatePreview();
        
        // Auto-ajustar altura
        this.style.height = 'auto';
        this.style.height = (this.scrollHeight) + 'px';
      });
      
      // Actualizar estado en tiempo real
      const activaCheckbox = document.getElementById('activaCheckbox');
      const estadoTexto = document.getElementById('estadoTexto');
      
      activaCheckbox.addEventListener('change', function() {
        if (this.checked) {
          estadoTexto.textContent = 'Activa (visible para clientes)';
          estadoTexto.className = 'text-xs text-emerald-700';
        } else {
          estadoTexto.textContent = 'Inactiva (oculta para clientes)';
          estadoTexto.className = 'text-xs text-gray-600';
        }
        updatePreview();
      });
      
      // Inicializar vista previa
      updatePreview();
    });
    
    // Funciones de categorías
    function setCategory(category) {
      const categoriaInput = document.getElementById('categoriaInput');
      categoriaInput.value = category;
      updatePreview();
    }
    
    // Actualizar vista previa
    function updatePreview() {
      const pregunta = document.getElementById('preguntaInput').value || '¿Pregunta de ejemplo?';
      const respuesta = document.getElementById('respuestaInput').value || 'La respuesta aparecerá aquí...';
      const categoria = document.getElementById('categoriaInput').value;
      const activa = document.getElementById('activaCheckbox').checked;
      
      document.getElementById('previewPregunta').textContent = pregunta;
      document.getElementById('previewRespuesta').textContent = respuesta;
      
      const previewEstado = document.getElementById('previewEstado');
      if (activa) {
        previewEstado.className = 'text-xs px-3 py-1 rounded-full bg-emerald-100 text-emerald-800';
        previewEstado.innerHTML = '<i class="fas fa-eye mr-1"></i> Activa';
      } else {
        previewEstado.className = 'text-xs px-3 py-1 rounded-full bg-gray-100 text-gray-800';
        previewEstado.innerHTML = '<i class="fas fa-eye-slash mr-1"></i> Inactiva';
      }
      
      const previewCategoria = document.getElementById('previewCategoria');
      if (categoria) {
        previewCategoria.textContent = categoria;
        previewCategoria.className = 'px-2 py-1 rounded text-xs';
        
        // Asignar color según categoría
        const catLower = categoria.toLowerCase();
        if (catLower.includes('pago') || catLower.includes('dinero')) {
          previewCategoria.classList.add('bg-blue-100', 'text-blue-800');
        } else if (catLower.includes('servicio') || catLower.includes('atención')) {
          previewCategoria.classList.add('bg-green-100', 'text-green-800');
        } else if (catLower.includes('técnico') || catLower.includes('reparación')) {
          previewCategoria.classList.add('bg-purple-100', 'text-purple-800');
        } else {
          previewCategoria.classList.add('bg-gray-100', 'text-gray-800');
        }
      } else {
        previewCategoria.textContent = 'Sin categoría';
        previewCategoria.className = 'px-2 py-1 rounded bg-gray-100 text-gray-800 text-xs';
      }
    }
    
    // Limpiar formulario
    function clearForm() {
      if (confirm('¿Está seguro de que desea limpiar todos los campos del formulario?')) {
        document.getElementById('preguntaInput').value = '';
        document.getElementById('respuestaInput').value = '';
        document.getElementById('categoriaInput').value = '';
        document.getElementById('activaCheckbox').checked = true;
        
        // Actualizar contadores
        document.getElementById('preguntaCounter').textContent = '0';
        document.getElementById('respuestaCounter').textContent = '0';
        
        // Actualizar vista previa
        updatePreview();
        
        // Restaurar altura del textarea
        document.getElementById('respuestaInput').style.height = 'auto';
      }
    }
    
    // Confirmación al enviar
    const form = document.querySelector('form');
    if (form) {
      form.addEventListener('submit', function(e) {
        const button = this.querySelector('button[type="submit"]');
        const originalText = button.innerHTML;
        
        // Mostrar estado de carga
        button.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i> Guardando...';
        button.disabled = true;
        
        // Restaurar después de un tiempo
        setTimeout(() => {
          button.innerHTML = originalText;
          button.disabled = false;
        }, 3000);
      });
    }
  </script>

</body>
</html>